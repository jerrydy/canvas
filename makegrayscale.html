<!DOCTYPE html>
 
<html>
  <head>
    <title>Playing with Canvas Image</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
  </head>
 
  <body>
   
    <div>
      <canvas id="canvas" width="500" height="500"></canvas>
    </div>
    <script type="text/javascript">
      var canvas = document.querySelector("canvas");
      var ctx = canvas.getContext("2d");
      var pic = new Image ();
      pic.src = "images/fry.jpg";
      ctx.drawImage(pic, 0, 0, canvas.width, canvas.height);
      //ctx.fillRect(0,0,50,50);
      var img = ctx.getImageData (0, 0, canvas.width, canvas.height);
      var avg = 0;
      for (i=0; i< img.data.length; i+=4) {
        avg = (0.30 * img.data[i]) + (0.59 * img.data[i+1]) + (0.11 * img.data[i+2]);
        img.data[i] = avg;
        img.data[i+1] = avg;
        img.data[i+2] = avg;
      }
      ctx.putImageData(img,0,0);
    </script>
   
  </body>
</html> 